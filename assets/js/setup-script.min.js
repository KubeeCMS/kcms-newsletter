mailster=function(n,s,t,i){"use strict";var e=s(".mailster-setup-step"),a,l,d=s(".status"),r=s(".spinner"),c=location.hash.substr(1);if(c&&s("#step_"+c).length){a=s("#step_"+c)}else{a=e.eq(0)}l=a.attr("id").replace(/^step_/,"");e.hide();f(l);s("form.mailster-setup-step-form").on("submit",function(){s(".next-step:visible").hide();return false});s("#mailster-setup").on("click",".validation-skip-step",function(){return confirm(n.l10n.setup.skip_validation)}).on("click",".next-step",function(){if(s(this).hasClass("disabled"))return false;if(tinymce)tinymce.get("post_content").save();var t=s(this).parent().parent().find("form"),i=t.serialize();n.util.ajax("wizard_save",{id:l,data:i},function(t){})}).on("click",".load-language",function(){d.html(n.l10n.setup.load_language);r.css("visibility","visible");n.util.ajax("load_language",function(t){r.css("visibility","hidden");d.html(t.data.html);if(t.success){location.reload()}});return false}).on("click",".quick-install",function(){var t=s(this);v(t.data("plugin"),t.data("method"),t.parent())}).on("click",".edit-slug",function(){s(this).parent().parent().find("span").hide().filter(".edit-slug-area").show().find("input").focus().select()});n.$.document.on("verified.mailster",function(){s(".validation-next-step").removeClass("disabled");s(".validation-skip-step").addClass("disabled")});h();var u=s("#deliverynav"),o=s(".deliverytab");u.on("click","a.nav-tab",function(){u.find("a").removeClass("nav-tab-active");o.hide();var t=s(this).addClass("nav-tab-active").attr("href").substr(1);s("#deliverymethod").val(t);s("#deliverytab-"+t).show();if(s("#deliverytab-"+t).find(".quick-install").length){s(".delivery-next-step").addClass("disabled").html(sprintf(n.l10n.setup.enable_first,s(this).html()))}else{s(".delivery-next-step").removeClass("disabled").html(sprintf(n.l10n.setup.use_deliverymethod,s(this).html()))}return false});n.$.window.on("hashchange",function(){var t=location.hash.substr(1)||"start",i=s(".mailster-setup-steps-nav").find("a[href='#"+t+"']"),e,a;if(i.length){f(t);i.parent().parent().find("a").removeClass("next prev current");i.parent().prevAll().find("a").addClass("prev");i.addClass("current");if(tinymce&&tinymce.activeEditor)tinymce.activeEditor.theme.resizeTo("100%",200)}if("finish"==t){n.util.ajax("wizard_save",{id:t,data:null})}});n.events.push("documentReady",function(){n.$.window.trigger("hashchange")});function h(){d.html(n.l10n.setup.check_language);r.css("visibility","visible");n.util.ajax("check_language",function(t){r.css("visibility","hidden");d.html(t.data.html);if(t.success){}})}function f(t){var i=s("#step_"+t);if(i.length){a.hide();a=i;a.show();l=t}}function v(i,e,a,t){d.html(n.l10n.setup.install_addon);r.css("visibility","visible");n.util.ajax("quick_install",{plugin:i,method:e,step:"install"},function(t){d.html(n.l10n.setup.activate_addon);n.util.ajax("quick_install",{plugin:i,method:e,step:"activate"},function(t){d.html(n.l10n.setup.receiving_content);n.util.ajax("quick_install",{plugin:i,method:e,step:"content"},function(t){d.html("");r.css("visibility","hidden");a.html(t.data.content);u.find("a.nav-tab-active").trigger("click")})})})}return n}(mailster||{},jQuery,window,document);